-- Ejercicio 1: Crear un índice compuesto en las columnas id_editorial y titulo de la tabla libros

-- Sintaxis: CREATE INDEX nombre_indice ON tabla(columna1, columna2, ...)
CREATE INDEX idx_libros_id_editorial_titulo ON libros(id_editorial, titulo);

-- Verificar que el índice se creó correctamente
SHOW INDEX FROM libros;
-- Ejercicio 2: Crear un índice en la columna fecha_publicacion de la tabla libros

-- Sintaxis: CREATE INDEX nombre_indice ON tabla(columna)
CREATE INDEX idx_libros_fecha_publicacion ON libros(fecha_publicacion);

-- Verificar que el índice se creó correctamente
SHOW INDEX FROM libros;
-- Ejercicio 3: Eliminar el índice idx_libros_id_editorial_titulo de la tabla libros

-- Removido IF EXISTS para compatibilidad con versiones antiguas de MariaDB/MySQL
-- Sintaxis básica compatible con todas las versiones
DROP INDEX idx_libros_id_editorial_titulo ON libros;

-- Verificar que el índice se eliminó correctamente
SHOW INDEX FROM libros;
-- Ejercicio 4: Actualizar el índice idx_libros_id_editorial_titulo 
-- para que sea un índice único en la columna id_editorial

-- NOTA: En MariaDB/MySQL no se puede "actualizar" un índice directamente.
-- Como el ejercicio 3 ya eliminó el índice, aquí solo lo recreamos como UNIQUE.

-- Removido el DROP INDEX porque el ejercicio 3 ya lo eliminó
-- Crear el nuevo índice ÚNICO solo en id_editorial
CREATE UNIQUE INDEX idx_libros_id_editorial_titulo ON libros(id_editorial);

-- Verificar que el índice se creó correctamente como UNIQUE
SHOW INDEX FROM libros;
-- Ejercicio 5: ¿Se puede usar ALTER para resolver el ejercicio anterior?

-- RESPUESTA: SÍ, se puede usar ALTER TABLE para gestionar índices.
-- Aquí están las alternativas usando ALTER TABLE:

-- Opción 1: Eliminar índice con ALTER TABLE
-- ALTER TABLE libros DROP INDEX idx_libros_id_editorial_titulo;

-- Opción 2: Agregar índice único con ALTER TABLE
-- ALTER TABLE libros ADD UNIQUE INDEX idx_libros_id_editorial_titulo(id_editorial);

-- Removido IF EXISTS para compatibilidad con versiones antiguas de MariaDB
-- Opción 3: Solución completa del ejercicio 4 usando ALTER TABLE
ALTER TABLE libros DROP INDEX idx_libros_id_editorial_titulo;
ALTER TABLE libros ADD UNIQUE INDEX idx_libros_id_editorial_titulo(id_editorial);

-- Verificar
SHOW INDEX FROM libros;

-- CONCLUSIÓN:
-- Tanto CREATE INDEX/DROP INDEX como ALTER TABLE ADD INDEX/DROP INDEX son válidos.
-- ALTER TABLE es más versátil porque permite modificar múltiples aspectos de la tabla
-- en una sola sentencia, mientras que CREATE/DROP INDEX son más específicos.
-- NOTA: En versiones antiguas de MariaDB, IF EXISTS no está disponible con DROP INDEX.
-- Ejercicio 6: Crear un índice único en la columna id_editorial de la tabla editoriales

-- NOTA IMPORTANTE: La columna id_editorial ya es PRIMARY KEY, 
-- lo cual implica que ya es UNIQUE y tiene un índice.
-- Sin embargo, si se requiere crear un índice único adicional explícitamente:

-- Usando CREATE UNIQUE INDEX sin IF EXISTS para compatibilidad
CREATE UNIQUE INDEX idx_editoriales_id_editorial ON editoriales(id_editorial);

-- Opción 2: Usando ALTER TABLE
-- ALTER TABLE editoriales ADD UNIQUE INDEX idx_editoriales_id_editorial(id_editorial);

-- Verificar los índices
SHOW INDEX FROM editoriales;

-- NOTA: Es probable que MariaDB genere un error o advertencia porque id_editorial
-- ya es PRIMARY KEY (que es único por definición). En la práctica, este índice
-- adicional sería redundante.
-- Ejercicio 7: Crear un índice PRIMARY en la columna id_libro de la tabla libros

-- NOTA IMPORTANTE: La columna id_libro ya tiene definida una PRIMARY KEY
-- en la creación de la tabla. No se puede tener más de una PRIMARY KEY por tabla.

-- Para demostrar el ejercicio, primero eliminamos y recreamos la PRIMARY KEY
-- Paso 1: Eliminar la PRIMARY KEY existente
ALTER TABLE libros DROP PRIMARY KEY;

-- Paso 2: Agregar la PRIMARY KEY nuevamente
ALTER TABLE libros ADD PRIMARY KEY (id_libro);

-- Verificar los índices
SHOW INDEX FROM libros;

-- CONCLUSIÓN:
-- La columna id_libro ya tenía un índice PRIMARY KEY desde la creación de la tabla.
-- Una tabla solo puede tener UNA PRIMARY KEY.
-- Este script demuestra cómo agregar una PRIMARY KEY usando ALTER TABLE.
